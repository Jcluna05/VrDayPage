!function(e){e("#sm-metabox-icons-settings-tabs").on("click","a.mi-settings-nav-tab",function(t){var i=e(this).blur(),n=e("#"+i.data("type"));t.preventDefault(),t.stopPropagation(),i.parent().addClass("tabs").siblings().removeClass("tabs"),n.removeClass("tabs-panel-inactive").addClass("tabs-panel-active").show().siblings("div.tabs-panel").hide().addClass("tabs-panel-inactive").removeClass("tabs-panel-active")}).find("a.mi-settings-nav-tab").first().click(),e("#sm-metabox-icons-settings-save").on("click",function(t){var i=e(this).prop("disabled",!0),n=i.siblings("span.spinner");t.preventDefault(),t.stopPropagation(),n.css({display:"inline-block",visibility:"visible"}),e.ajax({type:"POST",url:Slick_Menu_Icons.ajaxUrls.update,data:e("#sm-metabox-icons-settings :input").serialize(),success:function(e){!0===e.success&&e.data.redirectUrl?(window.location=e.data.redirectUrl,n.css({display:"none",visibility:"hidden"}),i.prop("disabled",!1)):i.prop("disabled",!1)},always:function(){n.hide()}})})}(jQuery),function e(t,i,n){function s(o,l){if(!i[o]){if(!t[o]){var r="function"==typeof require&&require;if(!l&&r)return r(o,!0);if(a)return a(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var d=i[o]={exports:{}};t[o][0].call(d.exports,function(e){var i=t[o][1][e];return s(i||e)},d,d.exports,e,t,i,n)}return i[o].exports}for(var a="function"==typeof require&&require,o=0;o<n.length;o++)s(n[o]);return s}({1:[function(e,t,i){wp.media.model.SlickMenu_IconsItemSettingField=e("./models/item-setting-field.js"),wp.media.model.SlickMenu_IconsItemSettings=e("./models/item-settings.js"),wp.media.model.SlickMenu_IconsItem=e("./models/item.js"),wp.media.view.SlickMenu_IconsItemSettingField=e("./views/item-setting-field.js"),wp.media.view.SlickMenu_IconsItemSettings=e("./views/item-settings.js"),wp.media.view.SlickMenu_IconsItemPreview=e("./views/item-preview.js"),wp.media.view.SlickMenu_IconsSidebar=e("./views/sidebar.js"),wp.media.view.MediaFrame.SlickMenu_Icons=e("./views/frame.js")},{"./models/item-setting-field.js":2,"./models/item-settings.js":3,"./models/item.js":4,"./views/frame.js":5,"./views/item-preview.js":6,"./views/item-setting-field.js":7,"./views/item-settings.js":8,"./views/sidebar.js":9}],2:[function(e,t,i){var n=Backbone.Model.extend({defaults:{id:"",label:"",value:"",type:"text"}});t.exports=n},{}],3:[function(e,t,i){var n=Backbone.Collection.extend({model:wp.media.model.SlickMenu_IconsItemSettingField});t.exports=n},{}],4:[function(e,t,i){var n=Backbone.Model.extend({initialize:function(){this.on("change",this.updateValues,this)},updateValues:function(){_.each(this.get("$inputs"),function(e,t){e.val(this.get(t))},this),this.get("$el").trigger("mi:update")}});t.exports=n},{}],5:[function(e,t,i){var n=wp.media.view.MediaFrame.IconPicker.extend({initialize:function(){this.menuItems=new Backbone.Collection([],{model:wp.media.model.SlickMenu_IconsItem}),wp.media.view.MediaFrame.IconPicker.prototype.initialize.apply(this,arguments),this.listenTo(this.target,"change",this.miUpdateItemProps),this.on("select",this.miClearTarget,this)},miUpdateItemProps:function(e){this.menuItems.get(e.id).set(e.changed)},miClearTarget:function(){this.target.clear({silent:!0})}});t.exports=n},{}],6:[function(e,t,i){var n=wp.media.View.extend({tagName:"p",className:"mi-preview menu-item attachment-info",events:{"click a":"preventDefault"},initialize:function(){wp.media.View.prototype.initialize.apply(this,arguments),this.model.on("change",this.render,this)},render:function(){var e=this.controller.state(),t=e.get("selection").single(),i=this.model.toJSON(),n=_.extend(i,{type:e.id,icon:t.id,title:this.model.get("$title").val(),url:e.ipGetIconUrl(t,i.image_size)}),s="slick-menu-icons-item-sidebar-preview-"+iconPicker.types[e.id].templateId+"-";return n.hide_label?s+="hide_label":s+=n.position,this.template=wp.media.template(s),this.$el.html(this.template(n)),this},preventDefault:function(e){e.preventDefault()}});t.exports=n},{}],7:[function(e,t,i){var n,s=jQuery;n=wp.media.View.extend({tagName:"label",className:"setting",events:{"change :input":"_update"},initialize:function(){wp.media.View.prototype.initialize.apply(this,arguments),this.template=wp.media.template("sm-metabox-icons-settings-field-"+this.model.get("type")),this.model.on("change",this.render,this)},prepare:function(){return this.model.toJSON()},_update:function(e){var t=s(e.currentTarget).val();this.model.set("value",t),this.options.item.set(this.model.id,t)}}),t.exports=n},{}],8:[function(e,t,i){var n=wp.media.view.PriorityList.extend({className:"mi-settings attachment-info",prepare:function(){_.each(this.collection.map(this.createField,this),function(e){this.set(e.model.id,e)},this)},createField:function(e){return new wp.media.view.SlickMenu_IconsItemSettingField({item:this.model,model:e,collection:this.collection})}});t.exports=n},{}],9:[function(e,t,i){var n=wp.media.view.IconPickerSidebar.extend({initialize:function(){var e=new wp.media.View({tagName:"h3",priority:-10}),t=new wp.media.View({tagName:"p",className:"_info",priority:1e3});wp.media.view.IconPickerSidebar.prototype.initialize.apply(this,arguments),e.$el.text(Slick_Menu_Icons.text.preview),this.set("title",e),t.$el.html(Slick_Menu_Icons.text.settingsInfo),this.set("info",t)},createSingle:function(){this.createPreview(),this.createSettings()},disposeSingle:function(){this.unset("preview"),this.unset("settings")},createPreview:function(){var e=this,t=e.controller,i=t.state();i.dfd&&"pending"===i.dfd.state()?i.dfd.done(function(){e.createPreview()}):e.set("preview",new wp.media.view.SlickMenu_IconsItemPreview({controller:t,model:t.target,priority:80}))},createSettings:function(){var e=this.controller,t=e.state().get("data").settingsFields,i=[];_.each(t,function(t){var n,s=Slick_Menu_Icons.settingsFields[t];s&&(n=_.defaults({value:e.target.get(t)||s.default},s),i.push(n))}),i.length&&this.set("settings",new wp.media.view.SlickMenu_IconsItemSettings({controller:this.controller,collection:new wp.media.model.SlickMenu_IconsItemSettings(i),model:e.target,type:this.options.type,priority:120}))}});t.exports=n},{}]},{},[1]),function(e){"use strict";var t;Slick_Menu_Icons.activeTypes&&!_.isEmpty(Slick_Menu_Icons.activeTypes)&&(t={templates:{},wrapClass:"div.slick-menu-icons-wrap",frame:null,target:new wp.media.model.IconPickerTarget,typesFilter:function(t){return-1<e.inArray(t.id,Slick_Menu_Icons.activeTypes)},createFrame:function(){t.frame=new wp.media.view.MediaFrame.SlickMenu_Icons({target:t.target,ipTypes:_.filter(iconPicker.types,t.typesFilter),SidebarView:wp.media.view.SlickMenu_IconsSidebar})},pickIcon:function(e){t.frame.target.set(e,{silent:!0}),t.frame.open()},setUnset:function(i){var n=e(i.currentTarget),s=e(i.target);i.preventDefault(),s.hasClass("_select")||s.hasClass("_icon")?t.setIcon(n):s.hasClass("_remove")&&t.unsetIcon(n)},setIcon:function(i){var n=i.data("id"),s=t.frame.menuItems,a=s.get(n);a?t.pickIcon(a.toJSON()):(a={id:n,$el:i,$title:e("#edit-menu-item-title-"+n),$inputs:{}},i.find("div._settings input").each(function(){var t=e(this),i=t.attr("class").replace("_mi-",""),n=t.val();n||(_.has(Slick_Menu_Icons.menuSettings,i)?n=Slick_Menu_Icons.menuSettings[i]:_.has(Slick_Menu_Icons.settingsFields,i)&&(n=Slick_Menu_Icons.settingsFields[i].default)),a[i]=n,a.$inputs[i]=t}),s.add(a),t.pickIcon(a))},unsetIcon:function(e){var i=e.data("id");e.find("div._settings input").val(""),e.trigger("mi:update"),t.frame.menuItems.remove(i)},updateField:function(i){var n,s=e(i.currentTarget),a=s.find("a._select"),o=s.find("a._remove"),l=s.find("input._mi-type").val(),r=s.find("input._mi-icon").val(),c=s.find("input._mi-url").val();if(""===l||""===r||0>_.indexOf(Slick_Menu_Icons.activeTypes,l))return a.text(Slick_Menu_Icons.text.select).attr("title",""),void o.addClass("hidden");n=t.templates[l]?t.templates[l]:t.templates[l]=wp.template("slick-menu-icons-item-field-preview-"+iconPicker.types[l].templateId),o.removeClass("hidden"),a.attr("title",Slick_Menu_Icons.text.change),a.html(n({type:l,icon:r,url:c}))},init:function(){t.createFrame(),e(document).on("click",t.wrapClass,t.setUnset).on("mi:update",t.wrapClass,t.updateField),e(document).on("sm_mb_init_events",function(i,n){e(n.target).find(t.wrapClass).trigger("mi:update")}),e(t.wrapClass).trigger("mi:update")}}).init()}(jQuery);